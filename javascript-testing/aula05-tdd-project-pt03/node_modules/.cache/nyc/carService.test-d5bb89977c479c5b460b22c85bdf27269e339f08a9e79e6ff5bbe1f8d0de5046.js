function cov_1eyh53q8ap(){var path="/home/eduardo/jsExpert/javascript-testing/aula05-tdd-project-pt03/test/unitTests/carService.test.js";var hash="bf364d6e89be18214632b5aebaef067ae4025e9e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/home/eduardo/jsExpert/javascript-testing/aula05-tdd-project-pt03/test/unitTests/carService.test.js",statementMap:{"0":{start:{line:1,column:48},end:{line:1,column:64}},"1":{start:{line:2,column:19},end:{line:2,column:34}},"2":{start:{line:3,column:14},end:{line:3,column:30}},"3":{start:{line:5,column:17},end:{line:5,column:32}},"4":{start:{line:7,column:19},end:{line:7,column:60}},"5":{start:{line:8,column:20},end:{line:8,column:63}},"6":{start:{line:10,column:21},end:{line:10,column:69}},"7":{start:{line:12,column:14},end:{line:16,column:1}},"8":{start:{line:18,column:0},end:{line:131,column:2}},"9":{start:{line:19,column:19},end:{line:19,column:21}},"10":{start:{line:20,column:16},end:{line:20,column:18}},"11":{start:{line:21,column:2},end:{line:25,column:4}},"12":{start:{line:22,column:4},end:{line:24,column:6}},"13":{start:{line:27,column:2},end:{line:29,column:4}},"14":{start:{line:28,column:4},end:{line:28,column:35}},"15":{start:{line:31,column:2},end:{line:33,column:4}},"16":{start:{line:32,column:4},end:{line:32,column:21}},"17":{start:{line:35,column:2},end:{line:40,column:4}},"18":{start:{line:36,column:17},end:{line:36,column:32}},"19":{start:{line:37,column:19},end:{line:37,column:62}},"20":{start:{line:39,column:4},end:{line:39,column:55}},"21":{start:{line:41,column:2},end:{line:55,column:4}},"22":{start:{line:42,column:24},end:{line:42,column:46}},"23":{start:{line:43,column:23},end:{line:43,column:24}},"24":{start:{line:45,column:4},end:{line:48,column:25}},"25":{start:{line:50,column:19},end:{line:50,column:58}},"26":{start:{line:51,column:21},end:{line:51,column:51}},"27":{start:{line:53,column:4},end:{line:53,column:69}},"28":{start:{line:54,column:4},end:{line:54,column:40}},"29":{start:{line:56,column:2},end:{line:77,column:4}},"30":{start:{line:57,column:16},end:{line:57,column:30}},"31":{start:{line:58,column:24},end:{line:58,column:61}},"32":{start:{line:59,column:4},end:{line:59,column:33}},"33":{start:{line:61,column:4},end:{line:64,column:19}},"34":{start:{line:66,column:4},end:{line:69,column:5}},"35":{start:{line:71,column:19},end:{line:71,column:64}},"36":{start:{line:72,column:21},end:{line:72,column:24}},"37":{start:{line:74,column:4},end:{line:74,column:34}},"38":{start:{line:75,column:4},end:{line:75,column:58}},"39":{start:{line:76,column:4},end:{line:76,column:45}},"40":{start:{line:78,column:2},end:{line:96,column:4}},"41":{start:{line:79,column:21},end:{line:79,column:55}},"42":{start:{line:80,column:4},end:{line:80,column:21}},"43":{start:{line:82,column:24},end:{line:82,column:61}},"44":{start:{line:83,column:4},end:{line:83,column:28}},"45":{start:{line:85,column:25},end:{line:85,column:26}},"46":{start:{line:87,column:21},end:{line:87,column:61}},"47":{start:{line:89,column:4},end:{line:89,column:90}},"48":{start:{line:89,column:58},end:{line:89,column:89}},"49":{start:{line:91,column:19},end:{line:93,column:5}},"50":{start:{line:95,column:4},end:{line:95,column:45}},"51":{start:{line:97,column:2},end:{line:130,column:4}},"52":{start:{line:98,column:16},end:{line:98,column:30}},"53":{start:{line:99,column:24},end:{line:103,column:5}},"54":{start:{line:105,column:21},end:{line:105,column:55}},"55":{start:{line:106,column:4},end:{line:106,column:21}},"56":{start:{line:108,column:25},end:{line:108,column:26}},"57":{start:{line:109,column:20},end:{line:109,column:44}},"58":{start:{line:111,column:16},end:{line:111,column:37}},"59":{start:{line:113,column:4},end:{line:113,column:40}},"60":{start:{line:114,column:4},end:{line:117,column:19}},"61":{start:{line:119,column:27},end:{line:119,column:66}},"62":{start:{line:120,column:19},end:{line:120,column:77}},"63":{start:{line:122,column:21},end:{line:127,column:6}},"64":{start:{line:129,column:4},end:{line:129,column:45}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:18,column:35},end:{line:18,column:36}},loc:{start:{line:18,column:41},end:{line:131,column:1}},line:18},"1":{name:"(anonymous_1)",decl:{start:{line:21,column:9},end:{line:21,column:10}},loc:{start:{line:21,column:15},end:{line:25,column:3}},line:21},"2":{name:"(anonymous_2)",decl:{start:{line:27,column:13},end:{line:27,column:14}},loc:{start:{line:27,column:19},end:{line:29,column:3}},line:27},"3":{name:"(anonymous_3)",decl:{start:{line:31,column:12},end:{line:31,column:13}},loc:{start:{line:31,column:18},end:{line:33,column:3}},line:31},"4":{name:"(anonymous_4)",decl:{start:{line:35,column:56},end:{line:35,column:57}},loc:{start:{line:35,column:62},end:{line:40,column:3}},line:35},"5":{name:"(anonymous_5)",decl:{start:{line:41,column:62},end:{line:41,column:63}},loc:{start:{line:41,column:68},end:{line:55,column:3}},line:41},"6":{name:"(anonymous_6)",decl:{start:{line:56,column:62},end:{line:56,column:63}},loc:{start:{line:56,column:74},end:{line:77,column:3}},line:56},"7":{name:"(anonymous_7)",decl:{start:{line:78,column:95},end:{line:78,column:96}},loc:{start:{line:78,column:101},end:{line:96,column:3}},line:78},"8":{name:"(anonymous_8)",decl:{start:{line:89,column:52},end:{line:89,column:53}},loc:{start:{line:89,column:58},end:{line:89,column:89}},line:89},"9":{name:"(anonymous_9)",decl:{start:{line:97,column:83},end:{line:97,column:84}},loc:{start:{line:97,column:95},end:{line:130,column:3}},line:97}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"bf364d6e89be18214632b5aebaef067ae4025e9e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1eyh53q8ap=function(){return actualCoverage;};}return actualCoverage;}cov_1eyh53q8ap();const{describe,it,beforeEach,afterEach}=(cov_1eyh53q8ap().s[0]++,require('mocha'));const{expect}=(cov_1eyh53q8ap().s[1]++,require('chai'));const sinon=(cov_1eyh53q8ap().s[2]++,require('sinon'));const{join}=(cov_1eyh53q8ap().s[3]++,require('path'));const CarService=(cov_1eyh53q8ap().s[4]++,require('./../../src/service/carService'));const Transaction=(cov_1eyh53q8ap().s[5]++,require('./../../src/entities/transaction'));const carsDatabase=(cov_1eyh53q8ap().s[6]++,join(__dirname,'./../../database','cars.json'));const mocks=(cov_1eyh53q8ap().s[7]++,{validCar:require('./../mocks/valid-car.json'),validCarCategory:require('./../mocks/valid-carCategory.json'),validCustomer:require('./../mocks/valid-customer.json')});cov_1eyh53q8ap().s[8]++;describe('CarService Suite Tests',()=>{cov_1eyh53q8ap().f[0]++;let carService=(cov_1eyh53q8ap().s[9]++,{});let sandbox=(cov_1eyh53q8ap().s[10]++,{});cov_1eyh53q8ap().s[11]++;before(()=>{cov_1eyh53q8ap().f[1]++;cov_1eyh53q8ap().s[12]++;carService=new CarService({cars:carsDatabase});});cov_1eyh53q8ap().s[13]++;beforeEach(()=>{cov_1eyh53q8ap().f[2]++;cov_1eyh53q8ap().s[14]++;sandbox=sinon.createSandbox();});cov_1eyh53q8ap().s[15]++;afterEach(()=>{cov_1eyh53q8ap().f[3]++;cov_1eyh53q8ap().s[16]++;sandbox.restore();});cov_1eyh53q8ap().s[17]++;it('should retrieve a random position from an array',()=>{cov_1eyh53q8ap().f[4]++;const data=(cov_1eyh53q8ap().s[18]++,[0,1,2,3,4]);const result=(cov_1eyh53q8ap().s[19]++,carService.getRandomPositionFromArray(data));cov_1eyh53q8ap().s[20]++;expect(result).to.be.lte(data.length).and.be.gte(0);});cov_1eyh53q8ap().s[21]++;it('should choose the first id from carIds in carCategory',()=>{cov_1eyh53q8ap().f[5]++;const carCategory=(cov_1eyh53q8ap().s[22]++,mocks.validCarCategory);const carIdIndex=(cov_1eyh53q8ap().s[23]++,0);cov_1eyh53q8ap().s[24]++;sandbox.stub(carService,carService.getRandomPositionFromArray.name).returns(carIdIndex);const result=(cov_1eyh53q8ap().s[25]++,carService.chooseRandomCar(carCategory));const expected=(cov_1eyh53q8ap().s[26]++,carCategory.carIds[carIdIndex]);cov_1eyh53q8ap().s[27]++;expect(carService.getRandomPositionFromArray.calledOnce).to.be.ok;cov_1eyh53q8ap().s[28]++;expect(result).to.be.equal(expected);});cov_1eyh53q8ap().s[29]++;it('given a carCategory it should return an available car',async()=>{cov_1eyh53q8ap().f[6]++;const car=(cov_1eyh53q8ap().s[30]++,mocks.validCar);const carCategory=(cov_1eyh53q8ap().s[31]++,Object.create(mocks.validCarCategory));cov_1eyh53q8ap().s[32]++;carCategory.carIds=[car.id];cov_1eyh53q8ap().s[33]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);cov_1eyh53q8ap().s[34]++;sandbox.spy(carService,carService.chooseRandomCar.name);const result=(cov_1eyh53q8ap().s[35]++,await carService.getAvailableCar(carCategory));const expected=(cov_1eyh53q8ap().s[36]++,car);cov_1eyh53q8ap().s[37]++;console.log('console',car.id);cov_1eyh53q8ap().s[38]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_1eyh53q8ap().s[39]++;expect(result).to.be.deep.equal(expected);});cov_1eyh53q8ap().s[40]++;it('given a carService, customer and numberOfDays it should calculate final amount in real',()=>{cov_1eyh53q8ap().f[7]++;const customer=(cov_1eyh53q8ap().s[41]++,Object.create(mocks.validCustomer));cov_1eyh53q8ap().s[42]++;customer.age=50;const carCategory=(cov_1eyh53q8ap().s[43]++,Object.create(mocks.validCarCategory));cov_1eyh53q8ap().s[44]++;carCategory.price=37.6;const numberOfDays=(cov_1eyh53q8ap().s[45]++,5);const expected=(cov_1eyh53q8ap().s[46]++,carService.currencyFormat.format(244.40));cov_1eyh53q8ap().s[47]++;sandbox.stub(carService,'taxesBasedOnAge').get(()=>{cov_1eyh53q8ap().f[8]++;cov_1eyh53q8ap().s[48]++;return[{from:40,to:50,then:1.3}];});const result=(cov_1eyh53q8ap().s[49]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_1eyh53q8ap().s[50]++;expect(result).to.be.deep.equal(expected);});cov_1eyh53q8ap().s[51]++;it('given a customer and a car category it should return a transaction receipt',async()=>{cov_1eyh53q8ap().f[9]++;const car=(cov_1eyh53q8ap().s[52]++,mocks.validCar);const carCategory=(cov_1eyh53q8ap().s[53]++,{...mocks.validCarCategory,carIds:[car.id],price:37.6});const customer=(cov_1eyh53q8ap().s[54]++,Object.create(mocks.validCustomer));cov_1eyh53q8ap().s[55]++;customer.age=20;const numberOfDays=(cov_1eyh53q8ap().s[56]++,5);const dueDate=(cov_1eyh53q8ap().s[57]++,'10 de novembro de 2023');const now=(cov_1eyh53q8ap().s[58]++,new Date(2023,10,5));cov_1eyh53q8ap().s[59]++;sandbox.useFakeTimers(now.getTime());cov_1eyh53q8ap().s[60]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);const expectedAmount=(cov_1eyh53q8ap().s[61]++,carService.currencyFormat.format(206.8));const result=(cov_1eyh53q8ap().s[62]++,await carService.rent(customer,carCategory,numberOfDays));const expected=(cov_1eyh53q8ap().s[63]++,new Transaction({customer,car,amount:expectedAmount,dueDate}));cov_1eyh53q8ap().s[64]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMWV5aDUzcThhcCIsImFjdHVhbENvdmVyYWdlIiwiZGVzY3JpYmUiLCJpdCIsImJlZm9yZUVhY2giLCJhZnRlckVhY2giLCJzIiwicmVxdWlyZSIsImV4cGVjdCIsInNpbm9uIiwiam9pbiIsIkNhclNlcnZpY2UiLCJUcmFuc2FjdGlvbiIsImNhcnNEYXRhYmFzZSIsIl9fZGlybmFtZSIsIm1vY2tzIiwidmFsaWRDYXIiLCJ2YWxpZENhckNhdGVnb3J5IiwidmFsaWRDdXN0b21lciIsImYiLCJjYXJTZXJ2aWNlIiwic2FuZGJveCIsImJlZm9yZSIsImNhcnMiLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImRhdGEiLCJyZXN1bHQiLCJnZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheSIsInRvIiwiYmUiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjYXJDYXRlZ29yeSIsImNhcklkSW5kZXgiLCJzdHViIiwibmFtZSIsInJldHVybnMiLCJjaG9vc2VSYW5kb21DYXIiLCJleHBlY3RlZCIsImNhcklkcyIsImNhbGxlZE9uY2UiLCJvayIsImVxdWFsIiwiY2FyIiwiT2JqZWN0IiwiY3JlYXRlIiwiaWQiLCJjYXJSZXBvc2l0b3J5IiwiZmluZCIsInJlc29sdmVzIiwic3B5IiwiZ2V0QXZhaWxhYmxlQ2FyIiwiY29uc29sZSIsImxvZyIsImRlZXAiLCJjdXN0b21lciIsImFnZSIsInByaWNlIiwibnVtYmVyT2ZEYXlzIiwiY3VycmVuY3lGb3JtYXQiLCJmb3JtYXQiLCJnZXQiLCJmcm9tIiwidGhlbiIsImNhbGN1bGF0ZUZpbmFsUHJpY2UiLCJkdWVEYXRlIiwibm93IiwiRGF0ZSIsInVzZUZha2VUaW1lcnMiLCJnZXRUaW1lIiwiZXhwZWN0ZWRBbW91bnQiLCJyZW50IiwiYW1vdW50Il0sInNvdXJjZXMiOlsiY2FyU2VydmljZS50ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZGVzY3JpYmUsIGl0LCBiZWZvcmVFYWNoLCBhZnRlckVhY2ggfSA9IHJlcXVpcmUoJ21vY2hhJylcbmNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJylcbmNvbnN0IHNpbm9uID0gcmVxdWlyZSgnc2lub24nKVxuXG5jb25zdCB7IGpvaW4gfSA9IHJlcXVpcmUoJ3BhdGgnKVxuXG5jb25zdCBDYXJTZXJ2aWNlID0gcmVxdWlyZSgnLi8uLi8uLi9zcmMvc2VydmljZS9jYXJTZXJ2aWNlJylcbmNvbnN0IFRyYW5zYWN0aW9uID0gcmVxdWlyZSgnLi8uLi8uLi9zcmMvZW50aXRpZXMvdHJhbnNhY3Rpb24nKVxuXG5jb25zdCBjYXJzRGF0YWJhc2UgPSBqb2luKF9fZGlybmFtZSwgJy4vLi4vLi4vZGF0YWJhc2UnLCAnY2Fycy5qc29uJylcblxuY29uc3QgbW9ja3MgPSB7XG4gIHZhbGlkQ2FyOiByZXF1aXJlKCcuLy4uL21vY2tzL3ZhbGlkLWNhci5qc29uJyksXG4gIHZhbGlkQ2FyQ2F0ZWdvcnk6IHJlcXVpcmUoJy4vLi4vbW9ja3MvdmFsaWQtY2FyQ2F0ZWdvcnkuanNvbicpLFxuICB2YWxpZEN1c3RvbWVyOiByZXF1aXJlKCcuLy4uL21vY2tzL3ZhbGlkLWN1c3RvbWVyLmpzb24nKVxufVxuXG5kZXNjcmliZSgnQ2FyU2VydmljZSBTdWl0ZSBUZXN0cycsICgpID0+IHtcbiAgbGV0IGNhclNlcnZpY2UgPSB7fVxuICBsZXQgc2FuZGJveCA9IHt9XG4gIGJlZm9yZSgoKSA9PiB7XG4gICAgY2FyU2VydmljZSA9IG5ldyBDYXJTZXJ2aWNlKHtcbiAgICAgIGNhcnM6IGNhcnNEYXRhYmFzZVxuICAgIH0pXG4gIH0pXG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7IFxuICAgIHNhbmRib3ggPSBzaW5vbi5jcmVhdGVTYW5kYm94KClcbiAgfSlcbiAgXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgc2FuZGJveC5yZXN0b3JlKClcbiAgfSlcblxuICBpdCgnc2hvdWxkIHJldHJpZXZlIGEgcmFuZG9tIHBvc2l0aW9uIGZyb20gYW4gYXJyYXknLCAoKSA9PiB7IFxuICAgIGNvbnN0IGRhdGEgPSBbMCwgMSwgMiwgMywgNF1cbiAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5KGRhdGEpXG5cbiAgICBleHBlY3QocmVzdWx0KS50by5iZS5sdGUoZGF0YS5sZW5ndGgpLmFuZC5iZS5ndGUoMClcbiAgfSlcbiAgaXQoJ3Nob3VsZCBjaG9vc2UgdGhlIGZpcnN0IGlkIGZyb20gY2FySWRzIGluIGNhckNhdGVnb3J5JywgKCkgPT4ge1xuICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gbW9ja3MudmFsaWRDYXJDYXRlZ29yeVxuICAgIGNvbnN0IGNhcklkSW5kZXggPSAwXG5cbiAgICBzYW5kYm94LnN0dWIoXG4gICAgICBjYXJTZXJ2aWNlLFxuICAgICAgY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheS5uYW1lXG4gICAgKS5yZXR1cm5zKGNhcklkSW5kZXgpXG5cbiAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhcihjYXJDYXRlZ29yeSlcbiAgICBjb25zdCBleHBlY3RlZCA9IGNhckNhdGVnb3J5LmNhcklkc1tjYXJJZEluZGV4XVxuXG4gICAgZXhwZWN0KGNhclNlcnZpY2UuZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkuY2FsbGVkT25jZSkudG8uYmUub2tcbiAgICBleHBlY3QocmVzdWx0KS50by5iZS5lcXVhbChleHBlY3RlZClcbiAgfSlcbiAgaXQoJ2dpdmVuIGEgY2FyQ2F0ZWdvcnkgaXQgc2hvdWxkIHJldHVybiBhbiBhdmFpbGFibGUgY2FyJywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNhciA9IG1vY2tzLnZhbGlkQ2FyXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgY2FyQ2F0ZWdvcnkuY2FySWRzID0gW2Nhci5pZF1cblxuICAgIHNhbmRib3guc3R1YihcbiAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeSxcbiAgICAgIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeS5maW5kLm5hbWUsXG4gICAgKS5yZXNvbHZlcyhjYXIpXG5cbiAgICBzYW5kYm94LnNweShcbiAgICAgIGNhclNlcnZpY2UsXG4gICAgICBjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5uYW1lXG4gICAgKVxuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY2FyU2VydmljZS5nZXRBdmFpbGFibGVDYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJcblxuICAgIGNvbnNvbGUubG9nKCdjb25zb2xlJywgY2FyLmlkKVxuICAgIGV4cGVjdChjYXJTZXJ2aWNlLmNob29zZVJhbmRvbUNhci5jYWxsZWRPbmNlKS50by5iZS5va1xuICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWwoZXhwZWN0ZWQpXG4gIH0pXG4gIGl0KCdnaXZlbiBhIGNhclNlcnZpY2UsIGN1c3RvbWVyIGFuZCBudW1iZXJPZkRheXMgaXQgc2hvdWxkIGNhbGN1bGF0ZSBmaW5hbCBhbW91bnQgaW4gcmVhbCcsICgpID0+IHtcbiAgICBjb25zdCBjdXN0b21lciA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDdXN0b21lcilcbiAgICBjdXN0b21lci5hZ2UgPSA1MFxuXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgY2FyQ2F0ZWdvcnkucHJpY2UgPSAzNy42XG5cbiAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1XG4gICAgXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJTZXJ2aWNlLmN1cnJlbmN5Rm9ybWF0LmZvcm1hdCgyNDQuNDApXG4gICAgXG4gICAgc2FuZGJveC5zdHViKGNhclNlcnZpY2UsICd0YXhlc0Jhc2VkT25BZ2UnKS5nZXQoKCkgPT4gW3tmcm9tOiA0MCwgdG86IDUwLCB0aGVuOiAxLjN9XSlcblxuICAgIGNvbnN0IHJlc3VsdCA9IGNhclNlcnZpY2UuY2FsY3VsYXRlRmluYWxQcmljZShcbiAgICAgIGN1c3RvbWVyLCBjYXJDYXRlZ29yeSwgbnVtYmVyT2ZEYXlzXG4gICAgKVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZClcbiAgfSlcbiAgaXQoJ2dpdmVuIGEgY3VzdG9tZXIgYW5kIGEgY2FyIGNhdGVnb3J5IGl0IHNob3VsZCByZXR1cm4gYSB0cmFuc2FjdGlvbiByZWNlaXB0JywgYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGNhciA9IG1vY2tzLnZhbGlkQ2FyXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSB7XG4gICAgICAuLi5tb2Nrcy52YWxpZENhckNhdGVnb3J5LFxuICAgICAgY2FySWRzOiBbY2FyLmlkXSxcbiAgICAgIHByaWNlOiAzNy42XG4gICAgfVxuXG4gICAgY29uc3QgY3VzdG9tZXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ3VzdG9tZXIpXG4gICAgY3VzdG9tZXIuYWdlID0gMjBcblxuICAgIGNvbnN0IG51bWJlck9mRGF5cyA9IDVcbiAgICBjb25zdCBkdWVEYXRlID0gJzEwIGRlIG5vdmVtYnJvIGRlIDIwMjMnXG5cbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgyMDIzLCAxMCwgNSlcbiAgICBcbiAgICBzYW5kYm94LnVzZUZha2VUaW1lcnMobm93LmdldFRpbWUoKSlcbiAgICBzYW5kYm94LnN0dWIoXG4gICAgICBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnksXG4gICAgICBjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnkuZmluZC5uYW1lXG4gICAgKS5yZXNvbHZlcyhjYXIpXG5cbiAgICBjb25zdCBleHBlY3RlZEFtb3VudCA9IGNhclNlcnZpY2UuY3VycmVuY3lGb3JtYXQuZm9ybWF0KDIwNi44KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhclNlcnZpY2UucmVudChjdXN0b21lciwgY2FyQ2F0ZWdvcnksIG51bWJlck9mRGF5cylcblxuICAgIGNvbnN0IGV4cGVjdGVkID0gbmV3IFRyYW5zYWN0aW9uKHtcbiAgICAgIGN1c3RvbWVyLFxuICAgICAgY2FyLFxuICAgICAgYW1vdW50OiBleHBlY3RlZEFtb3VudCxcbiAgICAgIGR1ZURhdGVcbiAgICB9KVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZClcbiAgfSlcbn0pIl0sIm1hcHBpbmdzIjoiMnJNQWVZO0FBQUFBLGNBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQsY0FBQSxHQWZaLEtBQU0sQ0FBRUUsUUFBUSxDQUFFQyxFQUFFLENBQUVDLFVBQVUsQ0FBRUMsU0FBVSxDQUFDLEVBQUFMLGNBQUEsR0FBQU0sQ0FBQSxNQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQ2hFLEtBQU0sQ0FBRUMsTUFBTyxDQUFDLEVBQUFSLGNBQUEsR0FBQU0sQ0FBQSxNQUFHQyxPQUFPLENBQUMsTUFBTSxDQUFDLEVBQ2xDLEtBQU0sQ0FBQUUsS0FBSyxFQUFBVCxjQUFBLEdBQUFNLENBQUEsTUFBR0MsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUU5QixLQUFNLENBQUVHLElBQUssQ0FBQyxFQUFBVixjQUFBLEdBQUFNLENBQUEsTUFBR0MsT0FBTyxDQUFDLE1BQU0sQ0FBQyxFQUVoQyxLQUFNLENBQUFJLFVBQVUsRUFBQVgsY0FBQSxHQUFBTSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxnQ0FBZ0MsQ0FBQyxFQUM1RCxLQUFNLENBQUFLLFdBQVcsRUFBQVosY0FBQSxHQUFBTSxDQUFBLE1BQUdDLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQyxFQUUvRCxLQUFNLENBQUFNLFlBQVksRUFBQWIsY0FBQSxHQUFBTSxDQUFBLE1BQUdJLElBQUksQ0FBQ0ksU0FBUyxDQUFFLGtCQUFrQixDQUFFLFdBQVcsQ0FBQyxFQUVyRSxLQUFNLENBQUFDLEtBQUssRUFBQWYsY0FBQSxHQUFBTSxDQUFBLE1BQUcsQ0FDWlUsUUFBUSxDQUFFVCxP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